# 8. 디버깅 및 문제 해결 (Debugging & Troubleshooting)

개발보다 더 많은 시간을 쓰는 것이 바로 **디버깅**입니다.
에러가 났을 때 "왜 안 되지?"라고 고민만 하는 것보단, 도구(Debugger)와 로그(Log)를 통해 원인을 정확히 파악하는 것이 중요합니다.
본 문서는 **IntelliJ IDEA Ultimate** 환경을 기준으로 작성되었습니다.

---

## 1. IntelliJ 디버거 활용 (Ultimate)

`System.out.println`으로 변수를 찍어보는 시대는 지났습니다.
디버거를 사용하면 코드가 실행되는 도중에 멈추고, 변수 값을 뜯어보고, 강제로 값을 바꿔볼 수도 있습니다.

### 1.1 브레이크포인트 (Breakpoint) 설정
멈추고 싶은 코드 라인 번호 옆을 클릭하면 **빨간 점**이 생깁니다.
*   **Line Breakpoint**: 해당 라인 실행 직전에 멈춥니다. (가장 기본)
*   **Method Breakpoint**: 메소드 진입/종료 시점에 멈춥니다.
*   **Field Watchpoint**: 변수 값이 **변경**될 때 멈춥니다. (어디서 값을 바꾸는지 모를 때 유용)

### 1.2 디버그 모드로 실행
벌레 모양 아이콘(🪲)을 눌러 서버를 시작합니다.
코드가 실행되다가 브레이크포인트를 만나면 IntelliJ가 화면을 띄워줍니다.

### 1.3 핵심 기능 (Step 기능)
멈춘 시점에서 한 줄씩 코드를 실행하며 흐름을 따라갑니다.

| 기능 | 단축키 (Win) | 설명 |
|---|---|---|
| **Step Over** | F8 | 현재 줄을 실행하고 **다음 줄**로 넘어갑니다. (메소드 안으로 들어가지 않음) |
| **Step Into** | F7 | 현재 줄에 메소드가 있다면 **그 안으로** 들어갑니다. (상세 확인용) |
| **Step Out** | Shift + F8 | 현재 메소드를 끝까지 실행하고 **호출한 곳으로 빠져나갑니다.** |
| **Resume** | F9 | 다음 브레이크포인트까지 쭉 실행합니다. |

### 1.4 변수 값 확인 및 변경 (Evaluate Expression)
디버깅 중에 `Alt + F8`을 누르면 계산기 같은 창이 뜹니다.
*   현재 시점의 변수 값 확인 (`userVO.getName()`)
*   즉석에서 코드 실행 (`service.checkAuth(userVO)`)
*   **강제 값 변경**: 테스트하고 싶은 값으로 변수를 강제로 바꿔서 진행할 수 있습니다. (`userVO.setAdmin(true)`)

---

## 2. 로그 추적 (Log Tracing)

서버가 뱉어내는 로그는 암호가 아니라 **친절한 설명서**입니다.
겁먹지 말고 핵심 키워드를 찾는 연습이 필요합니다.

### 2.1 로그 레벨 이해
*   **ERROR**: 심각한 오류. 반드시 확인해야 합니다.
*   **WARN**: 잠재적 위험. 당장 에러는 아니지만 확인 필요.
*   **INFO**: 정상 작동 정보. (서버 시작, 요청 처리 완료 등)
*   **DEBUG**: 개발용 상세 정보. (변수 값, SQL 쿼리 등)

### 2.2 Stack Trace 분석법 (에러 추적)
에러가 나면 수십 줄의 영어가 쏟아집니다(Stack Trace). 중요한 건 위에서부터 첫 번째로 나오는 "내 코드"입니다.

**예시:**
```text
java.lang.NullPointerException
    at egovframework.example.sample.service.impl.EgovSampleServiceImpl.selectSampleList(EgovSampleServiceImpl.java:45)  <-- 여기!
    at egovframework.example.sample.web.EgovSampleController.selectSampleList(EgovSampleController.java:80)
    ...
    at org.springframework.web.servlet.DispatcherServlet.doDispatch(...)
```
*   `EgovSampleServiceImpl.java:45`: 이 파일 45번째 줄에서 에러가 났다는 뜻입니다. 바로 거기로 가면 됩니다.
*   **Caused by**: 여러 번 감싸진 에러의 경우, 맨 아래쪽의 `Caused by`가 진짜 원인인 경우가 많습니다.

### 2.3 SQL 로그 확인 (MyBatis)
`log4j2.xml` 설정이 잘 되어 있다면 콘솔에 SQL이 찍힙니다.
*   **Preparing**: 실행될 SQL 문장 (`?` 포함)
*   **Parameters**: `?`에 들어갈 값
*   **Total**: 조회된 행 개수

**팁**: SQL 에러가 났을 때는 콘솔에 찍힌 SQL을 그대로 복사해서 DB 툴(DBeaver 등)에서 실행해보세요. 문법 오류를 바로 잡을 수 있습니다.

---

## 3. 자주 만나는 에러 해결법

### 3.1 404 Not Found
*   **원인**: 요청한 URL을 처리할 Controller가 없음.
*   **해결**:
    1.  Controller Class 위에 `@Controller`가 있는지 확인.
    2.  `@RequestMapping("/주소.do")` 오타 확인.
    3.  `egov-com-servlet.xml`의 `component-scan` 패키지 범위 확인.

### 3.2 500 Internal Server Error
*   **원인**: 자바 코드 내부에서 에러 발생 (NullPointerException 등).
*   **해결**: 콘솔 로그(Stack Trace)의 첫 번째 줄을 보고 해당 라인 디버깅.

### 3.3 BeanCreationException
*   **원인**: 서버 켤 때 스프링 설정 꼬임 (주로 의존성 주입 실패).
*   **해결**: `Caused by`를 찾아서 어떤 빈(Bean)이 왜 못 만들어졌는지 확인. (보통 `@Service`나 `@Repository` 빼먹음, 또는 XML 오타)

---

### 요약
1.  **디버거**: `System.out` 대신 `F8`, `F7`을 생활화합시다. `Alt+F8`로 변수 조작은 신세계입니다.
2.  **로그**: 에러가 나면 무서워말고 `Caused by`와 `내 파일명:줄번호`를 찾으세요.
3.  **SQL**: MyBatis 로그를 통해 실제 실행되는 쿼리를 반드시 눈으로 확인하세요.
